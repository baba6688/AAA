2025-11-05 23:50:22,089 - DataWarehouseManager_test_warehouse - INFO - 数据仓库管理器 test_warehouse 初始化完成
2025-11-05 23:50:22,090 - DataWarehouseManager_test_warehouse - ERROR - 数据源注册失败: 'DataWarehouseManager' object has no attribute '_storage_nodes'
2025-11-05 23:50:22,090 - DataWarehouseManager_test_warehouse - ERROR - 数据模式注册失败: 'DataWarehouseManager' object has no attribute '_storage_nodes'
2025-11-05 23:50:22,091 - DataWarehouseManager_test_warehouse - ERROR - 数据验证失败: ['列 id 类型不匹配: 期望 int, 实际 int64', '列 name 类型不匹配: 期望 string, 实际 object', '列 email 类型不匹配: 期望 string, 实际 object']
2025-11-05 23:50:22,092 - DataWarehouseManager_test_warehouse - ERROR - 索引创建失败: 'DataWarehouseManager' object has no attribute '_storage_nodes'
2025-11-05 23:50:24,203 - DataWarehouseManager_test_warehouse - ERROR - 备份创建失败: 'DataWarehouseManager' object has no attribute '_storage_nodes'
2025-11-05 23:50:24,203 - DataWarehouseManager_test_warehouse - ERROR - 访问控制设置失败: 'DataWarehouseManager' object has no attribute '_access_control'
2025-11-05 23:50:24,203 - DataWarehouseManager_test_warehouse - ERROR - 权限检查失败: 'DataWarehouseManager' object has no attribute '_access_control'
2025-11-05 23:50:24,218 - DataWarehouseManager_test_warehouse - ERROR - 存储节点添加失败: 'DataWarehouseManager' object has no attribute '_storage_nodes'
2025-11-05 23:50:24,218 - DataWarehouseManager_test_warehouse - INFO - 开始数据重新分布，策略: balanced
2025-11-05 23:50:25,218 - DataWarehouseManager_test_warehouse - INFO - 数据重新分布完成
2025-11-05 23:50:25,220 - DataWarehouseManager_test_warehouse - ERROR - 获取系统状态失败: 'DataWarehouseManager' object has no attribute '_storage_nodes'
2025-11-05 23:50:25,220 - DataWarehouseManager_test_warehouse - INFO - 正在关闭数据仓库管理器...
2025-11-05 23:51:10,541 - DataWarehouseManager_test_warehouse - INFO - 数据仓库管理器 test_warehouse 初始化完成
2025-11-05 23:51:10,555 - DataWarehouseManager_test_warehouse - INFO - 数据源 test_db 注册成功
2025-11-05 23:51:10,588 - DataWarehouseManager_test_warehouse - INFO - 数据模式 users 注册成功
2025-11-05 23:51:10,602 - DataWarehouseManager_test_warehouse - INFO - 分区 users_id_1 创建成功
2025-11-05 23:51:10,602 - DataWarehouseManager_test_warehouse - ERROR - 分区数据保存失败: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-11-05 23:51:10,611 - DataWarehouseManager_test_warehouse - INFO - 分区 users_id_2 创建成功
2025-11-05 23:51:10,611 - DataWarehouseManager_test_warehouse - ERROR - 分区数据保存失败: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-11-05 23:51:10,621 - DataWarehouseManager_test_warehouse - INFO - 分区 users_id_3 创建成功
2025-11-05 23:51:10,624 - DataWarehouseManager_test_warehouse - ERROR - 分区数据保存失败: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-11-05 23:51:10,634 - DataWarehouseManager_test_warehouse - INFO - 分区 users_id_4 创建成功
2025-11-05 23:51:10,634 - DataWarehouseManager_test_warehouse - ERROR - 分区数据保存失败: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-11-05 23:51:10,645 - DataWarehouseManager_test_warehouse - INFO - 分区 users_id_5 创建成功
2025-11-05 23:51:10,645 - DataWarehouseManager_test_warehouse - ERROR - 分区数据保存失败: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-11-05 23:51:10,656 - DataWarehouseManager_test_warehouse - INFO - 表 users 分区优化完成
2025-11-05 23:51:10,666 - DataWarehouseManager_test_warehouse - INFO - 索引 users_email_idx 创建成功
2025-11-05 23:51:12,748 - DataWarehouseManager_test_warehouse - INFO - 备份创建成功: backup_20251105_235112_full
2025-11-05 23:51:12,758 - DataWarehouseManager_test_warehouse - INFO - 用户 test_user 访问控制设置成功
2025-11-05 23:51:12,792 - DataWarehouseManager_test_warehouse - INFO - 存储节点 node1 添加成功
2025-11-05 23:51:12,792 - DataWarehouseManager_test_warehouse - INFO - 开始数据重新分布，策略: balanced
2025-11-05 23:51:13,792 - DataWarehouseManager_test_warehouse - INFO - 数据重新分布完成
2025-11-05 23:51:13,808 - DataWarehouseManager_test_warehouse - INFO - 元数据导出成功: ./test_metadata.json
2025-11-05 23:51:13,813 - DataWarehouseManager_test_warehouse - ERROR - 元数据文件加载失败: 'DataSourceType.DATABASE' is not a valid DataSourceType
2025-11-05 23:51:13,824 - DataWarehouseManager_test_warehouse - INFO - 元数据导入成功: ./test_metadata.json
2025-11-05 23:51:13,824 - DataWarehouseManager_test_warehouse - INFO - 正在关闭数据仓库管理器...
2025-11-05 23:51:13,834 - DataWarehouseManager_test_warehouse - INFO - 数据仓库管理器已关闭
